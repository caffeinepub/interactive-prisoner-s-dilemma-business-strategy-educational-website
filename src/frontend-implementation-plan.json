{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Interactive Prisoner’s Dilemma (Business Strategy) educational website (Frontend)",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Build a responsive single-page layout with in-page navigation to Hero, Concepts, Payoff Matrix, Simulation, Dashboard, Business Applications, Insights & Analysis, and optional Business Analytics Mode sections.",
      "acceptanceCriteria": [
        "Page renders as a coherent, responsive layout on mobile and desktop",
        "Navigation (top nav or side nav) scrolls/jumps to each named section",
        "All sections listed in the requirement are present with headings and readable content"
      ],
      "file_operations": [
        {
          "path": "frontend/src/App.tsx",
          "operation": "create",
          "description": "Create the single-page app shell, including a responsive navigation bar (sticky on scroll) and semantic section wrappers with stable IDs for Hero, Concepts, Payoff Matrix, Simulation, Dashboard, Business Applications, Insights & Analysis, and a conditional Business Analytics Mode section. Use shadcn-ui components (e.g., Button, Card, Separator) for consistent structure; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/components/layout/Section.tsx",
          "operation": "create",
          "description": "Add a reusable Section wrapper component to standardize spacing, section headings, anchor offsets for scroll-to navigation, and subtle reveal transitions. Use shadcn-ui primitives where relevant; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/components/layout/TopNav.tsx",
          "operation": "create",
          "description": "Implement the top navigation with links that scroll to each section, including mobile-friendly behavior (collapsed menu). Use shadcn-ui components (e.g., Button, Sheet/Dropdown if available) without editing immutable ui files; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/main.tsx",
          "operation": "modify",
          "description": "Ensure the app entry continues to render the new App component and that in-page navigation works smoothly (no route changes needed for a single-page scroller)."
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Apply a professional corporate theme (non-blue/purple primary), consistent typography/spacing, and subtle animations across the site.",
      "acceptanceCriteria": [
        "Theme is applied consistently across all sections (headings, cards, buttons, charts)",
        "Primary palette is not blue/purple-dominant",
        "Animations are subtle (e.g., section reveal, hover states) and do not impede usability"
      ],
      "file_operations": [
        {
          "path": "frontend/src/index.css",
          "operation": "create",
          "description": "Create/define global Tailwind base styles and CSS variables for a business theme (e.g., charcoal/emerald/amber accents) that avoids blue/purple-dominant primaries; include subtle motion defaults (reveal/hover transitions) and improved typography for presentation-ready readability."
        },
        {
          "path": "frontend/tailwind.config.js",
          "operation": "modify",
          "description": "Tune theme tokens (colors and chart palette variables) to match the corporate palette and ensure consistent styling for cards, buttons, and chart colors. Keep animations subtle and reuse existing tailwindcss-animate utilities."
        },
        {
          "path": "frontend/src/components/layout/AppLayout.tsx",
          "operation": "create",
          "description": "Add a layout component to enforce consistent max-width, vertical rhythm, and background styling across sections. Use shadcn-ui Card/Separator patterns as needed; verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Implement the Concepts section with business-framed explanations of players, actions, payoffs, dominant strategy, Nash equilibrium, and the one-shot defection outcome using Firm A/Firm B naming.",
      "acceptanceCriteria": [
        "Section includes explicit definitions of Dominant Strategy and Nash Equilibrium",
        "Text uses business framing (prices/profits) and remains non-technical",
        "Firm A/Firm B naming is used consistently"
      ],
      "file_operations": [
        {
          "path": "frontend/src/features/content/ConceptsSection.tsx",
          "operation": "create",
          "description": "Create the Concept Explanation section content with clear headings, definitions, and business examples (high prices vs undercutting, profits as payoffs) using consistent Firm A/Firm B language. Use shadcn-ui components (e.g., Card) for readable content blocks; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Wire the ConceptsSection into the page flow and navigation targets; ensure it is reachable via the in-page nav and uses the required section heading."
        }
      ]
    },
    {
      "id": "REQ-4",
      "summary": "Create an interactive payoff matrix editor with adjustable payoffs, dominance/Nash detection and highlighting, and a dynamic business-friendly explanation that updates on changes.",
      "acceptanceCriteria": [
        "Users can modify all 8 payoff numbers (A and B payoffs for each cell) via UI controls",
        "Matrix visually highlights detected dominant strategy(ies) and Nash equilibrium cell(s) when applicable",
        "Explanation text updates immediately after any payoff change and remains understandable in business terms"
      ],
      "file_operations": [
        {
          "path": "frontend/src/features/payoff/PayoffMatrixSection.tsx",
          "operation": "create",
          "description": "Implement the Payoff Matrix section that renders a 2x2 matrix with default values and provides numeric inputs/sliders for all 8 payoff fields. Visually highlight dominant strategies and any pure-strategy Nash equilibrium cell(s), and show a live-updating explanation box in business terms. Use shadcn-ui Input/Slider/Card/Badge components; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/features/payoff/payoffAnalysis.ts",
          "operation": "create",
          "description": "Add pure frontend payoff-matrix analysis utilities to detect (when possible) dominant strategies and at least one pure-strategy Nash equilibrium; include concise comments explaining the logic in business framing (best-response, profit comparison)."
        },
        {
          "path": "frontend/src/features/payoff/usePayoffMatrix.ts",
          "operation": "create",
          "description": "Create a React Query-powered hook to load the payoff matrix from the backend interface and update it when the user edits values, keeping UI state responsive while syncing changes. Use the core-infrastructure backend connection configuration for calls; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Wire the PayoffMatrixSection into the single-page structure and ensure navigation jumps to it correctly."
        }
      ]
    },
    {
      "id": "REQ-5",
      "summary": "Implement simulation controls for one-shot and repeated games (1–100 rounds) with selectable strategies, and drive the simulation using backend-provided results while revealing round decisions simultaneously and updating cumulative profits.",
      "acceptanceCriteria": [
        "User can choose game mode (one-shot or repeated) and set rounds within 1–100 for repeated mode",
        "User can select a strategy for Firm A and for Firm B from the specified list",
        "Simulation produces a per-round action pair (A action, B action) and computes payoffs from the current payoff matrix",
        "Cumulative profits update correctly and match the sum of round payoffs"
      ],
      "file_operations": [
        {
          "path": "frontend/src/features/simulation/SimulationSection.tsx",
          "operation": "create",
          "description": "Create the Simulation section with controls for mode selection (one-shot vs repeated), rounds (1–100), and strategy selectors for Firm A and Firm B (Always Cooperate/Defect, Tit-for-Tat, Random, Grim Trigger). Start simulation via backend calls and present round results with simultaneous reveal (A & B shown together per round) and cumulative profit display. Use shadcn-ui Select/Tabs/Button/Card components; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/features/simulation/strategies.ts",
          "operation": "create",
          "description": "Define the allowed strategy identifiers/labels for UI selection, ensuring they match what the backend expects. Include brief comments mapping each strategy to its business intuition (e.g., retaliation/trust)."
        },
        {
          "path": "frontend/src/features/simulation/useSimulationRunner.ts",
          "operation": "create",
          "description": "Implement a client-side simulation playback controller that takes the backend SimulationResult and reveals rounds over time (or immediately for one-shot), producing derived state for 'current round', cumulative totals, and cooperation rate for real-time dashboard updates."
        },
        {
          "path": "frontend/src/features/state/useGameStore.ts",
          "operation": "create",
          "description": "Add a small predictable state module (React hooks) to coordinate payoff matrix state, selected strategies, mode/round count, latest backend result, and playback state without creating a monolithic component."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Wire the Simulation section into the single-page layout and navigation."
        }
      ]
    },
    {
      "id": "REQ-6",
      "summary": "Add a real-time dashboard with cumulative-profit line chart, cooperation rate, round history table, and a strategy comparison visualization that updates during simulation playback.",
      "acceptanceCriteria": [
        "Charts/tables update as rounds progress (or immediately after completing a one-shot) without page reload",
        "Cumulative profit line chart shows two series (Firm A, Firm B) across rounds",
        "History table lists each round with actions and payoffs",
        "Dashboard shows a cooperation rate metric as a percentage"
      ],
      "file_operations": [
        {
          "path": "frontend/src/features/dashboard/DashboardSection.tsx",
          "operation": "create",
          "description": "Implement the Dashboard section that consumes simulation playback state and renders: (1) cumulative profit line chart, (2) cooperation rate metric(s), (3) round-by-round history table, and (4) a strategy comparison visualization. Use shadcn-ui Card/Table/Badge components for layout and readability; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/features/dashboard/CumulativeProfitChart.tsx",
          "operation": "create",
          "description": "Create a lightweight chart component (e.g., SVG-based) that plots two series (Firm A and Firm B cumulative profits) and updates as the current revealed round advances, using the themed chart colors."
        },
        {
          "path": "frontend/src/features/dashboard/ActionsComparisonViz.tsx",
          "operation": "create",
          "description": "Add a strategy comparison visualization (e.g., per-round action markers or stacked cooperation frequency by firm) that updates in real time during playback. Use shadcn-ui Tooltip/Badge where helpful; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/features/dashboard/RoundsHistoryTable.tsx",
          "operation": "create",
          "description": "Render the round-by-round history table (round number, both actions, per-round payoffs, cumulative totals), showing rows up to the currently revealed round during playback. Use shadcn-ui Table components; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Wire the Dashboard section into the single-page layout and ensure it reflects the current simulation state without reload."
        }
      ]
    },
    {
      "id": "REQ-7",
      "summary": "Create a Business Applications section with the required real-world parallels and clear connections to trust, repeated interaction, and long-term strategy.",
      "acceptanceCriteria": [
        "Section includes all four listed real-world parallels",
        "Section explicitly ties repeated interactions to the possibility of cooperation",
        "Language stays business-focused and presentation-ready"
      ],
      "file_operations": [
        {
          "path": "frontend/src/features/content/BusinessApplicationsSection.tsx",
          "operation": "create",
          "description": "Add a Business Applications section explaining oligopoly pricing wars, cartel instability, airline price competition, and telecom price undercutting, explicitly tying them to trust, repeated interaction, and long-term strategy. Use shadcn-ui Card/Accordion components if available for structured presentation; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Wire the Business Applications section into the single-page layout and navigation."
        }
      ]
    },
    {
      "id": "REQ-8",
      "summary": "Display an Insights & Analysis panel after simulation completion with Nash equilibrium identification, profit comparison, cooperation sustainability, and a concise strategic interpretation.",
      "acceptanceCriteria": [
        "Insights appear when the simulation completes (or immediately for one-shot)",
        "Panel includes all four required insight items",
        "Strategic interpretation is generated from the run’s results and remains readable for a BBA viva"
      ],
      "file_operations": [
        {
          "path": "frontend/src/features/insights/InsightsSection.tsx",
          "operation": "create",
          "description": "Implement the Insights & Analysis section that appears after one-shot completion or after the final revealed repeated round. Include: identified Nash equilibrium (from matrix analysis / backend analysis), total profits comparison, sustained cooperation flag, and an auto-generated business interpretation (non-technical). Use shadcn-ui Card/Alert components; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/features/insights/interpretation.ts",
          "operation": "create",
          "description": "Create a small interpretation generator that converts run results into concise business language (e.g., one-shot defection vs repeated cooperation emergence), with brief comments explaining the mapping rules."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Wire the Insights & Analysis section into the single-page layout and ensure it reacts to simulation completion state."
        }
      ]
    },
    {
      "id": "REQ-9",
      "summary": "Add an optional Business Analytics Mode toggle that reveals a payoff heatmap, expected value calculations with explicit assumptions, risk analysis, and a one-shot vs repeated comparison view without resetting unrelated state.",
      "acceptanceCriteria": [
        "Toggle exists and can be turned on/off without resetting unrelated UI state",
        "When enabled, the specified analytics elements are visible; when disabled, they are hidden",
        "Expected value and risk metrics are computed from defined probabilities/assumptions that are shown in the UI (no hidden magic)"
      ],
      "file_operations": [
        {
          "path": "frontend/src/features/analytics/BusinessAnalyticsMode.tsx",
          "operation": "create",
          "description": "Implement the Business Analytics Mode block gated by a toggle. When enabled, render: payoff heatmap, expected value calculator with explicit probability/assumption controls shown in the UI, risk analysis summary, and a comparison view of one-shot vs repeated results. Use shadcn-ui Switch/Slider/Input/Card components; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/features/analytics/analyticsMath.ts",
          "operation": "create",
          "description": "Add frontend utilities to compute expected value and simple risk metrics (e.g., best/worst-case and dispersion) based on user-visible assumptions. Keep computations business-readable and documented with brief comments."
        },
        {
          "path": "frontend/src/features/state/useGameStore.ts",
          "operation": "modify",
          "description": "Extend state handling to persist the Business Analytics Mode toggle and retain prior one-shot and repeated results for comparison, ensuring toggling does not reset unrelated UI state."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Wire the Business Analytics Mode toggle into navigation and render the analytics section conditionally (optional section) while keeping the rest of the page stable."
        }
      ]
    },
    {
      "id": "REQ-10",
      "summary": "Integrate the frontend with backend simulation and payoff-matrix capabilities, using backend responses as the source of truth for simulation outcomes.",
      "acceptanceCriteria": [
        "Backend provides callable methods to run simulations using the selected strategies and current payoff matrix",
        "Frontend uses backend responses as the source of truth for simulation outcomes (actions, payoffs, totals)",
        "If any persistence is added, it survives canister upgrade via stable variables (migration file only if needed)"
      ],
      "file_operations": [
        {
          "path": "frontend/src/api/backendClient.ts",
          "operation": "create",
          "description": "Create a typed backend client wrapper around the generated backend interface (from frontend/src/backend.d.ts) to call: getPayoffMatrix, updatePayoffMatrix, runOneShot, runRepeatedGame, and optionally getAnalysis/getSimulationHistory. Use the core-infrastructure backend connection configuration and ensure calls can work with the existing identity provider context if present; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/features/payoff/usePayoffMatrix.ts",
          "operation": "modify",
          "description": "Update the payoff matrix hook to use the backendClient wrapper for querying and mutations via React Query, ensuring the UI stays in sync with backend state."
        },
        {
          "path": "frontend/src/features/simulation/SimulationSection.tsx",
          "operation": "modify",
          "description": "Ensure simulation runs are initiated through backendClient and the returned SimulationResult drives all displayed actions/payoffs/totals (frontend playback should only control reveal timing, not results)."
        }
      ]
    },
    {
      "id": "REQ-11",
      "summary": "Refactor frontend into modular components (matrix, controls, backend adapter, visualization, insights) with concise explanatory comments and predictable state flow.",
      "acceptanceCriteria": [
        "Frontend code is split into focused components (no single massive component for the entire app)",
        "Strategy logic and payoff calculations have brief explanatory comments",
        "State flow is predictable and does not require editing any immutable template hook paths"
      ],
      "file_operations": [
        {
          "path": "frontend/src/features/prisonersDilemma/PrisonersDilemmaPage.tsx",
          "operation": "create",
          "description": "Create a page-level orchestrator component that composes the section components (Hero, Concepts, Payoff Matrix, Simulation, Dashboard, Business Applications, Insights, Analytics) while keeping each feature modular. Use shadcn-ui components for consistent page composition; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/features/content/HeroSection.tsx",
          "operation": "create",
          "description": "Add the Hero section content (business strategy framing, brief instructions) with a clean corporate presentation style and subtle transitions. Use shadcn-ui Button/Card as appropriate; verify the component's usage instructions before implementing."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Refactor App to delegate most content to PrisonersDilemmaPage and shared layout components, ensuring no single file becomes overly large and all required sections remain wired into navigation."
        }
      ]
    }
  ]
}